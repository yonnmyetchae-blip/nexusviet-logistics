<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Nexus Admin</title>
</head>
<body>

<h2>Create Shipment</h2>

<label>Sender Name</label><br>
<input id="sender_name"><br><br>

<label>Sender Phone</label><br>
<input id="sender_phone"><br><br>

<label>Receiver Info</label><br>
<input id="receiver_info"><br><br>

<label>Route</label><br>
<select id="route">
  <option value="YGN – DN">YGN – DN</option>
  <option value="DN – YGN">DN – YGN</option>
</select><br><br>

<label>Flight Date</label><br>
<input type="date" id="flight_date"><br><br>

<label>Item Description</label><br>
<input id="item_desc"><br><br>

<label>Quantity</label><br>
<input type="number" id="quantity"><br><br>

<label>Handling Fee</label><br>
<input type="number" id="handling_fee"><br><br>

<label>Weight (KG)</label><br>
<input type="number" id="weight_kg"><br><br>

<label>Rate MMK</label><br>
<input type="number" id="rate_mmk"><br><br>

<label>Total VND</label><br>
<input type="number" id="total_vnd"><br><br>

<button onclick="submitShipment()">Create</button>

<script>
function submitShipment() {

  const sender_name   = document.getElementById("sender_name").value;
  const sender_phone  = document.getElementById("sender_phone").value;
  const receiver_info = document.getElementById("receiver_info").value;
  const route         = document.getElementById("route").value;
  const flight_date   = document.getElementById("flight_date").value;
  const item_desc     = document.getElementById("item_desc").value;
  const quantity      = Number(document.getElementById("quantity").value || 0);
  const handling_fee  = Number(document.getElementById("handling_fee").value || 0);
  const weight_kg     = Number(document.getElementById("weight_kg").value || 0);
  const rate_mmk      = Number(document.getElementById("rate_mmk").value || 0);
  const total_vnd     = Number(document.getElementById("total_vnd").value || 0);
  const status        = document.getElementById("status").value;

  const tracking_no = "NXS-" + Date.now();
  const invoice_no  = "INV-2026-" + Math.floor(Math.random() * 1000);

  const total_mmk = (handling_fee * quantity) + (weight_kg * rate_mmk);

  const data = {
    tracking_no,
    invoice_no,
    sender_name,
    sender_phone,
    receiver_info,
    route,
    flight_date,
    item_desc,
    quantity,
    handling_fee,
    weight_kg,
    rate_mmk,
    total_mmk,
    total_vnd,
    status
  };

  fetch("https://script.google.com/macros/s/AKfycbwoyNzupluztEPyAKdm7jhu8RA-VZkBZ-dBb9Iyu6gDK0oEn_6DMrJgg5SQ6_GA_0wk/exec", {
    method: "POST",
    body: JSON.stringify(data)
  })
  .then(res => res.text())
  .then(() => {
    window.location.href =
      "invoice.html?tracking=" + tracking_no;
  });
}
</script>

</body>
</html>
