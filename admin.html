<!DOCTYPE html>
<html>
<head>
<title>Nexus Viet Air Cargo – Admin</title>
</head>

<style>
body { font-family: Arial, sans-serif; max-width: 900px; margin: auto; }
label { font-weight: bold; display: block; margin-top: 10px; }
input, textarea, select { width: 100%; padding: 6px; margin-top: 4px; }
button { padding: 10px 16px; font-size: 16px; margin-top: 20px; }
</style>
</head>

<body>

<h2>Create Shipment – Nexus Viet Air Cargo</h2>

<form id="shipmentForm">
Sender Name: <input required id="Sender_Name"><br><br>
Sender Phone: <input id="Sender_Phone"><br><br>
Receiver Name: <input id="Receiver_Name"><br><br>
Receiver Phone: <input id="Receiver_Phone"><br><br>
Receiver Address: <input id="Receiver_Address"><br><br>

Route:
<select id="route">
<option>YGN – HCM</option>
<option>YGN – Hanoi</option>
<option>YGN – DaNang</option>
<option>HCM – YGN</option>
<option>Hanoi – YGN</option>
<option>DaNang – YGN</option>
</select><br><br>

Flight Date: <input type="date" id="flight"><br><br>
Item Description: <input id="item"><br><br>

Quantity (Package): <input type="number" id="quantity"><br><br>
Handling Fee per Package (MMK): <input type="number" id="handling_fee_mmk"><br><br>
Weight (KG): <input type="number" id="weight"><br><br>

Rate per KG MMK: <input type="number" id="rateMMK"><br><br>
Rate per KG VND: <input type="number" id="rateVND"><br><br>

Status:
<select id="Status">
<option>Received</option>
<option>In transit</option>
<option>Arrived</option>
<option>Delivered</option>
</select><br><br>

Remarks: <input id="Remarks"><br><br>

<button type="submit">Generate Invoice</button>
</form>

<script>
document.getElementById("shipmentForm").onsubmit = async function(e) {
e.preventDefault();

const tracking = "NXS-" + Date.now();
const invoice = "INV-" + new Date().getFullYear() + "-" + Math.floor(Math.random()*1000);

const qty = Number(document.getElementById("Quantity").value || 0);
const handling = Number(document.getElementById("Handling_Fee_MMK").value || 0);

const handlingTotal = qty * handling;
const weightVal = +weight.value;
const totalMMK = +itemMMK.value + (weightVal * +rateMMK.value);
const totalVND = +itemVND.value + (weightVal * +rateVND.value);

const payload = {
tracking_no: tracking,
invoice_no: invoice,
sender_name: sendername.value,
sender_phone: senderphone.value,
route: route.value,
flight_date: flightdate.value,
item_description: item.value,
quantity: quantity.value,
handling_fee_mmk: handlingfeeMMK.value,
weight_kg: weightVal,
rate_mmk: rateMMK.value,
rate_vnd: rateVND.value,
total_mmk: totalMMK,
total_vnd: totalVND,
status: Status.value,
remarks: ""
};

await fetch("https://script.google.com/macros/s/AKfycbwoyNzupluztEPyAKdm7jhu8RA-VZkBZ-dBb9Iyu6gDK0oEn_6DMrJgg5SQ6_GA_0wk/exec", {
method: "POST",
body: JSON.stringify(payload)
});

window.open(`invoice.html?tracking=${tracking}&invoice=${invoice}&mmk=${totalMMK}&vnd=${totalVND}`);
};
</script>

</body>
</html>
